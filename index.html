<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="static/css/aboutme/style.css">
    <link rel="stylesheet" href="static/css/home.css">
    <script type="text/javascript" src="static/js/lilhx.js"></script>
    <title>Leyuskc</title>
</head>

<body>
    <div class="wm">
        <div class="application_window">
            <app clickable handler="about_me_func" dragable float=".application_window">
                <div class="icon">
                    <img src="/static/img/low_side_pp.jpeg" alt="">
                </div>
                <div class="title">
                    About Me
                </div>
            </app>
            <app class = "st" clickable handler="toTaskBar" fetch="/desktop/terminal.html" append target="body" dragable
                float=".application_window">
                <div class="icon">
                    <img src="/static/img/terminal.jpg" alt="">
                </div>
                <div class="title">
                    ST
                </div>
            </app>
            <app class = "projects" clickable handler="toTaskBar" fetch="/desktop/projects.html" append target="body" dragable
                float=".application_window">
                <div class="icon">
                    <img src="/static/img/projects.jpg" alt="">
                </div>
                <div class="title">
                    Projects
                </div>
            </app>
            <app class = "files" clickable handler="toTaskBar" fetch="/desktop/files.html" append target="body" dragable
                float=".application_window">
                <div class="icon">
                    <img src="/static/img/folder.png" alt="">
                </div>
                <div class="title">
                    Files
                </div>
            </app>
        </div>
        <div class="task_bar">
            <text>
                made-with-<a href="https://github.com/leyuskckiran1510/lilhx">lilhx</a>
            </text>
        </div>
    </div>

</body>
<script>
    about_me_func = (...x) => {
        window.open("/aboutme/", "_blank")
    }

    let stripAttrinbutes=(self)=>{
        self.removeAttribute("style")
        self.removeAttribute("dragable")
        self.removeAttribute("clickable")
        self.removeAttribute("moving")
    }
    let reattachAttrinbutes=(self)=>{
        self.setAttribute("style","")
        self.setAttribute("dragable","")
        self.setAttribute("clickable","")
       
    }

    let ON_TASK_BAR = new Map()
    TASK_BAR = document.querySelector(".task_bar")
    toTaskBar = (self, target, fetch) => {
        ON_TASK_BAR.set(self, { style: self.getAttribute("style"),parent:self.parentNode })
        stripAttrinbutes(self)
        TASK_BAR.append(self)
        if(self.className.search("st")>=0){    
            document.querySelector(".terminal .body").addEventListener("keypress",(event)=>{
                console.log(event)
            })
        }
    }

    let findActionParent = (elemn)=>{
        let parent = elemn.parentNode
        while(parent && parent.getAttribute("app")==null){
            parent=parent.parentNode
        }
        return parent;
    }

    var close_window = (self,..._) => {
        let parent = findActionParent(self)
        ON_TASK_BAR.forEach((value,key,map)=>{
            if (parent.className.search(key.className)>=0){
                reattachAttrinbutes(key)
                value.parent.append(key)
                ON_TASK_BAR.delete(key)
            }
        })
        if(parent){
            parent.outerHTML=""
        }

    }
    var maxim_window = (self,..._) => {
        /*
            Storing the old style in `_style` attribute
            and on unmaximizing set the new style to old style
        
        */
        let _style = {
            top: "0",
            left: "0",
            width: "100%",
            height: "calc(100% - 5vh)",
        }
        let icons = ["⌧","☐"]
        let style_magic = ["","_"]
        let maximize=0
        let parent = findActionParent(self)
        if(self.innerText=="⌧"){
            maximize=1
        }
        self.innerText = icons[maximize]
        let old_style = parent.getAttribute(`${style_magic[maximize]}style`)
        parent.setAttribute(`${style_magic[(maximize+1)%2]}style`,old_style)
        !maximize?Object.assign(parent.style,_style):0
    }

    var minim_window = (self,..._) => {
        let parent = findActionParent(self)
        ON_TASK_BAR.forEach((value,key,map)=>{
            if (parent.className.search(key.className)>=0){
                key.onclick = ()=>{
                    parent.style.display="grid"
                }
            }
        })
        parent.style.display="none"
    }
</script>

</html>